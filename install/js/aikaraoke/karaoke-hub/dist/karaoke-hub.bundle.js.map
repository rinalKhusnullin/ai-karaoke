{"version":3,"file":"karaoke-hub.bundle.js","sources":["../src/karaoke-hub.js"],"sourcesContent":["import { ajax as Ajax } from 'main.core';\n\nimport './styles.css';\nimport 'ui.btn';\n\nexport class KaraokePlayer\n{\n\tconstructor() {\n\t\tthis.audioContext = null;\n\t\tthis.currentSlide = 0;\n\t\tthis.slides = [];\n\t\tthis.isPlaying = false;\n\t\tthis.audioElement = null;\n\t\tthis.timeline = [];\n\t\tthis.filesUploaded = false;\n\n\t\tthis.init();\n\t}\n\n\tinit() {\n\t\tthis.setupEventListeners();\n\t\tthis.initAudioContext();\n\t}\n\n\tsetupEventListeners() {\n\t\tconst uploadBtn = document.getElementById('upload-files-btn');\n\t\tconst generateBtn = document.getElementById('generate-karaoke-btn');\n\t\tconst playBtn = document.getElementById('play-karaoke-btn');\n\t\tconst confirmUploadBtn = document.getElementById('confirm-upload');\n\t\tconst cancelUploadBtn = document.getElementById('cancel-upload');\n\t\tconst modalCloseBtn = document.getElementById('upload-modal-close');\n\n\t\tif (uploadBtn) {\n\t\t\tuploadBtn.addEventListener('click', () => this.showUploadModal());\n\t\t}\n\n\t\tif (generateBtn) {\n\t\t\tgenerateBtn.addEventListener('click', () => this.generateKaraoke());\n\t\t}\n\n\t\tif (playBtn) {\n\t\t\tplayBtn.addEventListener('click', () => this.togglePlayback());\n\t\t}\n\n\t\tif (confirmUploadBtn) {\n\t\t\tconfirmUploadBtn.addEventListener('click', () => this.confirmUpload());\n\t\t}\n\n\t\tif (cancelUploadBtn) {\n\t\t\tcancelUploadBtn.addEventListener('click', () => this.hideUploadModal());\n\t\t}\n\n\t\tif (modalCloseBtn) {\n\t\t\tmodalCloseBtn.addEventListener('click', () => this.hideUploadModal());\n\t\t}\n\n\t\t// Закрытие модального окна по клику вне его\n\t\tconst modal = document.getElementById('upload-modal');\n\t\tif (modal) {\n\t\t\tmodal.addEventListener('click', (e) => {\n\t\t\t\tif (e.target === modal) {\n\t\t\t\t\tthis.hideUploadModal();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// Обработка изменения файлов\n\t\t['minus-file', 'plus-file', 'lyrics-text'].forEach(id => {\n\t\t\tconst element = document.getElementById(id);\n\t\t\tif (element) {\n\t\t\t\telement.addEventListener('change', () => this.validateUploadForm());\n\t\t\t\telement.addEventListener('input', () => this.validateUploadForm());\n\t\t\t}\n\t\t});\n\t}\n\n\tinitAudioContext() {\n\t\ttry {\n\t\t\tthis.audioContext = new (window.AudioContext || window.webkitAudioContext)();\n\t\t} catch (error) {\n\t\t\tconsole.error('Аудио контекст не поддерживается:', error);\n\t\t}\n\t}\n\n\tshowUploadModal() {\n\t\tconst modal = document.getElementById('upload-modal');\n\t\tif (modal) {\n\t\t\tmodal.style.display = 'block';\n\t\t\tthis.validateUploadForm();\n\t\t}\n\t}\n\n\thideUploadModal() {\n\t\tconst modal = document.getElementById('upload-modal');\n\t\tif (modal) {\n\t\t\tmodal.style.display = 'none';\n\t\t}\n\t}\n\n\tvalidateUploadForm() {\n\t\tconst minusFile = document.getElementById('minus-file').files[0];\n\t\tconst plusFile = document.getElementById('plus-file').files[0];\n\t\tconst lyricsText = document.getElementById('lyrics-text').value.trim();\n\t\tconst confirmBtn = document.getElementById('confirm-upload');\n\n\t\tconst isValid = minusFile && plusFile && lyricsText;\n\n\t\tif (confirmBtn) {\n\t\t\tconfirmBtn.disabled = !isValid;\n\t\t}\n\n\t\treturn isValid;\n\t}\n\n\tconfirmUpload() {\n\t\tif (this.validateUploadForm()) {\n\t\t\tthis.filesUploaded = true;\n\t\t\tdocument.getElementById('generate-karaoke-btn').disabled = false;\n\t\t\tthis.hideUploadModal();\n\n\t\t\t// Показываем информацию о загруженных файлах\n\t\t\tthis.showUploadedFilesInfo();\n\t\t}\n\t}\n\n\tshowUploadedFilesInfo() {\n\t\tconst minusFile = document.getElementById('minus-file').files[0];\n\t\tconst plusFile = document.getElementById('plus-file').files[0];\n\n\t\t// Можно добавить уведомление о успешной загрузке\n\t\tconsole.log('Файлы готовы к обработке:', {\n\t\t\tminus: minusFile.name,\n\t\t\tplus: plusFile.name\n\t\t});\n\t}\n\n\tasync generateKaraoke() {\n\t\tconst formData = new FormData();\n\t\tconst minusFile = document.getElementById('minus-file').files[0];\n\t\tconst plusFile = document.getElementById('plus-file').files[0];\n\t\tconst lyricsText = document.getElementById('lyrics-text').value;\n\n\t\tif (!minusFile || !plusFile || !lyricsText.trim()) {\n\t\t\talert('Пожалуйста, сначала загрузите все файлы через кнопку \"Загрузить файлы\"');\n\t\t\treturn;\n\t\t}\n\n\t\tformData.append('minus_file', minusFile);\n\t\tformData.append('plus_file', plusFile);\n\t\tformData.append('lyrics', lyricsText);\n\n\t\ttry {\n\t\t\tthis.showLoading(true);\n\n\t\t\tconst response = await Ajax.runAction('aikaraoke.Song.upload', {\n\t\t\t\tdata: {\n\t\t\t\t\tminusFile,\n\t\t\t\t\tplusFile,\n\t\t\t\t\tlyricsText,\n\t\t\t\t},\n\t\t\t\tmethod: 'POST',\n\t\t\t});\n\n\t\t\t// Проверяем статус ответа\n\t\t\tif (!response.ok) {\n\t\t\t\tthrow new Error(`HTTP error! status: ${response.status}`);\n\t\t\t}\n\n\t\t\t// Получаем текст ответа для отладки\n\t\t\tconst responseText = await response.text();\n\t\t\tconsole.log('Ответ сервера:', responseText);\n\n\t\t\t// Пытаемся распарсить JSON\n\t\t\tlet result;\n\t\t\ttry {\n\t\t\t\tresult = JSON.parse(responseText);\n\t\t\t} catch (parseError) {\n\t\t\t\tconsole.error('Ошибка парсинга JSON:', parseError);\n\t\t\t\tconsole.error('Полученный текст:', responseText);\n\t\t\t\tthrow new Error('Сервер вернул некорректный JSON ответ. Проверьте консоль браузера для деталей.');\n\t\t\t}\n\n\t\t\tif (result.success) {\n\t\t\t\tthis.slides = result.slides;\n\t\t\t\tthis.timeline = result.timeline;\n\t\t\t\tthis.displaySlides();\n\t\t\t\tthis.showKaraokePlayer();\n\n\t\t\t\t// Создаем аудио элемент для воспроизведения\n\t\t\t\tthis.createAudioElement(result.audio_url);\n\n\t\t\t\t// Активируем кнопку воспроизведения\n\t\t\t\tdocument.getElementById('play-karaoke-btn').disabled = false;\n\t\t\t} else {\n\t\t\t\talert('Ошибка генерации: ' + result.error);\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.error('Ошибка запроса:', error);\n\t\t\talert('Произошла ошибка при генерации караоке: ' + error.message);\n\t\t} finally {\n\t\t\tthis.showLoading(false);\n\t\t}\n\t}\n\n\tshowKaraokePlayer() {\n\t\tconst player = document.getElementById('karaoke-player');\n\t\tif (player) {\n\t\t\tplayer.style.display = 'block';\n\t\t\tplayer.scrollIntoView({ behavior: 'smooth' });\n\t\t}\n\t}\n\n\tcreateAudioElement(audioUrl) {\n\t\tif (this.audioElement) {\n\t\t\tthis.audioElement.remove();\n\t\t}\n\n\t\tthis.audioElement = document.createElement('audio');\n\t\tthis.audioElement.src = audioUrl;\n\t\tthis.audioElement.addEventListener('timeupdate', () => this.updateSlides());\n\t\tthis.audioElement.addEventListener('ended', () => this.onAudioEnded());\n\t\tthis.audioElement.addEventListener('loadedmetadata', () => this.updateTimeDisplay());\n\n\t\t// Добавляем прогресс бар\n\t\tconst progressBar = document.getElementById('progress-bar');\n\t\tif (progressBar) {\n\t\t\tprogressBar.addEventListener('click', (e) => this.seekAudio(e));\n\t\t}\n\n\t\tdocument.body.appendChild(this.audioElement);\n\t}\n\n\tseekAudio(e) {\n\t\tif (!this.audioElement) return;\n\n\t\tconst progressBar = e.currentTarget;\n\t\tconst rect = progressBar.getBoundingClientRect();\n\t\tconst clickX = e.clientX - rect.left;\n\t\tconst percentage = clickX / rect.width;\n\t\tconst newTime = percentage * this.audioElement.duration;\n\n\t\tthis.audioElement.currentTime = newTime;\n\t}\n\n\tupdateTimeDisplay() {\n\t\tif (!this.audioElement) return;\n\n\t\tconst timeDisplay = document.getElementById('time-display');\n\t\tconst progressFill = document.getElementById('progress-fill');\n\n\t\tif (timeDisplay) {\n\t\t\tconst current = this.formatTime(this.audioElement.currentTime);\n\t\t\tconst total = this.formatTime(this.audioElement.duration || 0);\n\t\t\ttimeDisplay.textContent = `${current} / ${total}`;\n\t\t}\n\n\t\tif (progressFill && this.audioElement.duration) {\n\t\t\tconst percentage = (this.audioElement.currentTime / this.audioElement.duration) * 100;\n\t\t\tprogressFill.style.width = `${percentage}%`;\n\t\t}\n\t}\n\n\tdisplaySlides() {\n\t\tconst container = document.getElementById('slides-container');\n\t\tif (!container) return;\n\n\t\tcontainer.innerHTML = '';\n\n\t\tthis.slides.forEach((slide, index) => {\n\t\t\tconst slideElement = document.createElement('div');\n\t\t\tslideElement.className = 'karaoke-slide';\n\t\t\tslideElement.id = `slide-${index}`;\n\t\t\tslideElement.innerHTML = `\n                <div class=\"slide-text\">${slide.text}</div>\n                <div class=\"slide-timing\">${this.formatTime(slide.start)} - ${this.formatTime(slide.end)}</div>\n            `;\n\n\t\t\t// Добавляем возможность перехода к слайду по клику\n\t\t\tslideElement.addEventListener('click', () => {\n\t\t\t\tif (this.audioElement) {\n\t\t\t\t\tthis.audioElement.currentTime = slide.start;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tcontainer.appendChild(slideElement);\n\t\t});\n\t}\n\n\tupdateSlides() {\n\t\tif (!this.audioElement || !this.slides.length) return;\n\n\t\tconst currentTime = this.audioElement.currentTime;\n\n\t\t// Обновляем время\n\t\tthis.updateTimeDisplay();\n\n\t\t// Находим текущий слайд\n\t\tconst newSlide = this.slides.findIndex(slide =>\n\t\t\tcurrentTime >= slide.start && currentTime <= slide.end\n\t\t);\n\n\t\tif (newSlide !== -1 && newSlide !== this.currentSlide) {\n\t\t\t// Убираем активный класс с предыдущего слайда\n\t\t\tconst prevSlide = document.getElementById(`slide-${this.currentSlide}`);\n\t\t\tif (prevSlide) {\n\t\t\t\tprevSlide.classList.remove('active');\n\t\t\t}\n\n\t\t\t// Добавляем активный класс текущему слайду\n\t\t\tconst currentSlideElement = document.getElementById(`slide-${newSlide}`);\n\t\t\tif (currentSlideElement) {\n\t\t\t\tcurrentSlideElement.classList.add('active');\n\t\t\t\tcurrentSlideElement.scrollIntoView({ behavior: 'smooth', block: 'center' });\n\t\t\t}\n\n\t\t\tthis.currentSlide = newSlide;\n\t\t}\n\t}\n\n\ttogglePlayback() {\n\t\tif (!this.audioElement) {\n\t\t\talert('Сначала сгенерируйте караоке');\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isPlaying) {\n\t\t\tthis.audioElement.pause();\n\t\t\tthis.isPlaying = false;\n\t\t\tdocument.getElementById('play-karaoke-btn').textContent = 'Воспроизвести';\n\t\t} else {\n\t\t\tthis.audioElement.play();\n\t\t\tthis.isPlaying = true;\n\t\t\tdocument.getElementById('play-karaoke-btn').textContent = 'Пауза';\n\t\t}\n\t}\n\n\tonAudioEnded() {\n\t\tthis.isPlaying = false;\n\t\tthis.currentSlide = 0;\n\t\tdocument.getElementById('play-karaoke-btn').textContent = 'Воспроизвести';\n\n\t\t// Убираем активные классы со всех слайдов\n\t\tdocument.querySelectorAll('.karaoke-slide.active').forEach(slide => {\n\t\t\tslide.classList.remove('active');\n\t\t});\n\t}\n\n\tshowLoading(show) {\n\t\tconst loader = document.getElementById('loading-overlay');\n\t\tif (loader) {\n\t\t\tloader.style.display = show ? 'block' : 'none';\n\t\t}\n\t}\n\n\tformatTime(seconds) {\n\t\tif (isNaN(seconds)) return '0:00';\n\t\tconst mins = Math.floor(seconds / 60);\n\t\tconst secs = Math.floor(seconds % 60);\n\t\treturn `${mins}:${secs.toString().padStart(2, '0')}`;\n\t}\n}\n"],"names":["KaraokePlayer","babelHelpers","this","audioContext","currentSlide","slides","isPlaying","audioElement","timeline","filesUploaded","init","key","value","setupEventListeners","initAudioContext","uploadBtn","document","getElementById","generateBtn","playBtn","confirmUploadBtn","cancelUploadBtn","modalCloseBtn","addEventListener","_this","showUploadModal","generateKaraoke","togglePlayback","confirmUpload","hideUploadModal","modal","e","target","forEach","id","element","validateUploadForm","window","AudioContext","webkitAudioContext","error","console","style","display","minusFile","files","plusFile","lyricsText","trim","confirmBtn","isValid","disabled","showUploadedFilesInfo","log","minus","name","plus","formData","FormData","_context","alert","append","showLoading","Ajax","runAction","data","method","response","ok","Error","status","text","responseText","result","JSON","parse","success","displaySlides","showKaraokePlayer","createAudioElement","audio_url","message","player","scrollIntoView","behavior","audioUrl","remove","createElement","src","_this2","updateSlides","onAudioEnded","updateTimeDisplay","progressBar","seekAudio","body","appendChild","rect","currentTarget","getBoundingClientRect","newTime","clientX","left","width","duration","currentTime","timeDisplay","progressFill","current","formatTime","total","textContent","percentage","container","innerHTML","slide","index","slideElement","className","_this3","start","end","length","newSlide","findIndex","prevSlide","classList","currentSlideElement","add","block","pause","play","querySelectorAll","show","loader","seconds","isNaN","mins","Math","floor","secs","toString","padStart"],"mappings":"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"}